1. 客户端建立连接，2 
2. 服务器根据自检状态决定是否通过连接，同意 3/拒绝 0
3. 服务器办法客户端uid，整个连接过程中为必须授权，4
4. 客户端根据自身业务，发起登陆（注册），5
5. 服务端验证登录信息有效，颁发session，6
6. 客户端发送消息到服务器，7
7. 服务器检查发送方式：回复 8/单发 9/群发 10/转发 11
8. 服务器根据业务逻辑返回客户端信息
9. 服务器根据要求，将信息发送给目标客户端（如果用户跨服务器，进行转发 11）
10. 服务器根据业务逻辑将信息群发给特定用户（如果跨服务器，进行转发抽奖11）
11. 跨服务请求会被转发到其他的服务器，根据业务执行 8/9/10



0.拒绝服务，客户端更换连接服务器

PS

redis存储uid、session的时候，也要根据业务关系反向存储冗余数据，保障业务可以方便的通知到全部端。